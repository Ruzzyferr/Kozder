---
import BaseLayout from '../layouts/BaseLayout.astro';
import ProjectCard from '../components/ProjectCard.astro';
import EventCard from '../components/EventCard.astro';
import PostCard from '../components/PostCard.astro';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const events = await getCollection('events');
const posts = await getCollection('posts');

// Get featured projects
const featuredProjects = projects
  .filter(p => p.data.featured)
  .sort((a, b) => b.data.year - a.data.year)
  .slice(0, 3);

// Get recent events
const recentEvents = events
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 3);

// Get recent posts
const recentPosts = posts
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
  .slice(0, 3);
---

<BaseLayout 
  title="KOZ-DER - Gençlik Zeka Oyunları ve Kodlama Derneği"
  description="Gençlerin gelişimine katkı sağlayan ESC ve Erasmus+ projeleri, etkinlikler ve duyurular."
>
  <!-- Hero Section with Image -->
  <section class="bg-white py-8 sm:py-12 md:py-16 fade-in-up">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8 lg:gap-12 items-center">
        <!-- Left: Text Content -->
        <div>
          <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-dark mb-4 sm:mb-6 leading-tight font-heading uppercase">
            European Solidarity Corps<br />
            <span class="text-primary-600">9 ay - 1 yıl</span><br />
            TÜRKİYE'de
          </h1>
          <div class="space-y-3 sm:space-y-4 text-gray-700 leading-relaxed text-sm sm:text-base md:text-lg">
            <p>
              Bu sayfada, Türkiye'de koordine ettiğimiz farklı European Solidarity Corps (ESC) projeleri için 
              gönüllü çağrılarımızı bulacaksınız. European Solidarity Corps, Avrupa Birliği tarafından finanse 
              edilen bir programdır. Projeler, Avrupa Birliği üye ve komşu ülkelerinden birinde ikamet eden 
              18-30 yaş arası gençlere açıktır. European Solidarity Corps programı hakkında detaylı bilgi ve 
              daha fazla proje için Avrupa Komisyonu'nun resmi web sayfasına bakabilirsiniz.
            </p>
            <p>
              Toplumsal ve sosyal projelere katılmaya istekli, yeni öğrenimler ve deneyimler için hazır genç 
              gönüllüler arıyoruz. Projelerimizden birine başvurursanız, sizi motivasyonunuz ve faaliyeti 
              anlayışınıza göre seçeceğiz, müfredatınıza göre değil.
            </p>
            <p>
              Destek organizasyonu olarak, bu deneyimi sizinle paylaşmaktan mutluluk duyarız.
            </p>
          </div>
          <div class="mt-6 sm:mt-8 flex flex-col sm:flex-row flex-wrap gap-3 sm:gap-4">
            <a 
              href="/projeler" 
              class="w-full sm:w-auto text-center bg-primary-600 text-white px-6 sm:px-8 py-2.5 sm:py-3 rounded-md font-bold hover:bg-primary-700 transition-colors uppercase tracking-wide font-heading text-sm sm:text-base"
            >
              Projelerimizi Keşfet
            </a>
            <a 
              href="https://europa.eu/youth/solidarity_en" 
              target="_blank"
              rel="noopener noreferrer"
              class="w-full sm:w-auto text-center bg-white text-primary-600 px-6 sm:px-8 py-2.5 sm:py-3 rounded-md font-bold hover:bg-gray-50 transition-colors border-2 border-primary-600 uppercase tracking-wide font-heading text-sm sm:text-base"
            >
              Avrupa Veritabanında Keşfet
            </a>
          </div>
        </div>
        
        <!-- Right: Large Image -->
        <div class="relative order-first lg:order-last">
          <div class="aspect-[4/3] rounded-lg overflow-hidden shadow-xl">
            <img 
              src="/images/hero-volunteers.jpg" 
              alt="KOZ-DER gönüllüleri"
              class="w-full h-full object-cover"
              onerror="this.src='/images/projects/placeholder.jpg'"
            />
          </div>
          <!-- EU Logo Badge -->
          <div class="absolute bottom-2 left-2 sm:bottom-4 sm:left-4 bg-white/90 backdrop-blur-sm px-2 py-1.5 sm:px-4 sm:py-2 rounded-lg shadow-lg">
            <div class="flex items-center space-x-1.5 sm:space-x-2">
              <div class="w-6 h-6 sm:w-8 sm:h-8 bg-blue-600 rounded-full flex items-center justify-center">
                <span class="text-white text-[10px] sm:text-xs font-bold">EU</span>
              </div>
              <span class="text-[10px] sm:text-xs font-semibold text-gray-700 hidden sm:inline">European Solidarity Corps</span>
              <span class="text-[10px] font-semibold text-gray-700 sm:hidden">ESC</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Projects -->
  {featuredProjects.length > 0 && (
    <section class="py-12 sm:py-16 md:py-20 bg-light fade-in-up">
      <div class="container mx-auto px-4">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-10">
          <div class="mb-4 sm:mb-0">
            <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-dark mb-2 font-heading uppercase">Öne Çıkan Projeler</h2>
            <p class="text-sm sm:text-base text-dark-text">ESC ve Erasmus+ programları kapsamında yürüttüğümüz projeler</p>
          </div>
          <a href="/projeler" class="text-primary-600 hover:text-primary-700 font-bold font-heading uppercase text-sm sm:text-base">
            Tümünü Gör →
          </a>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {featuredProjects.map((project) => (
            <ProjectCard
              title={project.data.title_tr}
              summary={project.data.summary_tr}
              coverImage={project.data.coverImage}
              programType={project.data.programType}
              year={project.data.year}
              status={project.data.status}
              slug={project.slug}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Recent Events -->
  {recentEvents.length > 0 && (
    <section class="py-12 sm:py-16 md:py-20 bg-white fade-in-up delay-200">
      <div class="container mx-auto px-4">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-10">
          <div class="mb-4 sm:mb-0">
            <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-dark mb-2 font-heading uppercase">Yaklaşan Etkinlikler</h2>
            <p class="text-sm sm:text-base text-dark-text">Düzenlediğimiz etkinlikler ve aktiviteler</p>
          </div>
          <a href="/etkinlikler" class="text-primary-600 hover:text-primary-700 font-bold font-heading uppercase text-sm sm:text-base">
            Tümünü Gör →
          </a>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {recentEvents.map((event) => (
            <EventCard
              title={event.data.title_tr}
              date={event.data.date}
              location={event.data.location}
              coverImage={event.data.coverImage}
              slug={event.slug}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Recent Announcements -->
  {recentPosts.length > 0 && (
    <section class="py-12 sm:py-16 md:py-20 bg-light fade-in-up delay-300">
      <div class="container mx-auto px-4">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-10">
          <div class="mb-4 sm:mb-0">
            <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-dark mb-2 font-heading uppercase">Son Duyurular</h2>
            <p class="text-sm sm:text-base text-dark-text">KOZ-DER'den güncel haberler ve duyurular</p>
          </div>
          <a href="/duyurular" class="text-primary-600 hover:text-primary-700 font-bold font-heading uppercase text-sm sm:text-base">
            Tümünü Gör →
          </a>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {recentPosts.map((post) => (
            <PostCard
              title={post.data.title_tr}
              summary={post.data.summary_tr}
              date={post.data.date}
              tags={post.data.tags}
              slug={post.slug}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- CTA Section -->
  <section class="py-12 sm:py-16 md:py-20 bg-primary-700 text-white fade-in-up">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-3 sm:mb-4">Bize Katılın</h2>
      <p class="text-base sm:text-lg md:text-xl mb-6 sm:mb-8 max-w-2xl mx-auto opacity-90 px-4">
        Projelerimizde yer almak veya daha fazla bilgi almak için bizimle iletişime geçin.
      </p>
      <a 
        href="/iletisim" 
        class="inline-block w-full sm:w-auto bg-white text-primary-700 px-6 sm:px-8 py-3 sm:py-4 rounded-lg font-semibold hover:bg-gray-100 transition-colors shadow-lg hover:shadow-xl text-sm sm:text-base"
      >
        İletişime Geç
      </a>
    </div>
  </section>
</BaseLayout>

